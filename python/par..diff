diff --git a/python/renombrar imagenes con codigos-catalogo.py b/python/renombrar imagenes con codigos-catalogo.py
index 5d86e71107eb829dffb7d08b39f41c7da857217f..3b8876962bf14f5bf49356fdd4c6a28e5f0a9f45 100644
--- a/python/renombrar imagenes con codigos-catalogo.py	
+++ b/python/renombrar imagenes con codigos-catalogo.py	
@@ -628,68 +628,109 @@ def _parse_number_for_excel(s: str):
 def update_product_in_file(
     path: str,
     row_number: int,
     code_col_index: int,
     name_col_index: int,
     category_col_index: int = -1,
     brand_col_index: int = -1,
     unit_price_col_index: int = -1,
     stock_col_index: int = -1,
     sheet_name: str = None,
     has_headers: bool = True,
     header_row_number: int = 1,
     new_code: str = "",
     new_name: str = "",
     new_category: str = "",
     new_brand: str = "",
     new_unit_price: str = "",
     new_stock: str = ""
 ):
     try:
         # ✅ NUEVO: asegurar guion bajo en lo que se guarda en Excel/CSV
         new_code = to_underscore_text(new_code)
         new_name = to_underscore_text(new_name)
 
         p = Path(path)
-        ...
+        if not p.exists() or p.is_dir():
+            return (False, "La ruta del archivo no existe o es una carpeta.")
+
+        ext = p.suffix.lower()
+        if row_number <= 0:
+            return (False, "Fila inválida (row_number).")
+
+        if header_row_number < 1:
+            header_row_number = 1
+
+        if has_headers and row_number == header_row_number:
+            return (False, "La fila a editar corresponde al encabezado.")
+
         if ext == ".csv":
             return _update_csv_row(
-                ...
+                p,
+                row_number=int(row_number),
+                code_col_index=int(code_col_index),
+                name_col_index=int(name_col_index),
+                category_col_index=int(category_col_index),
+                brand_col_index=int(brand_col_index),
+                unit_price_col_index=int(unit_price_col_index),
+                stock_col_index=int(stock_col_index),
                 new_code=new_code,
                 new_name=new_name,
-                ...
+                new_category=new_category,
+                new_brand=new_brand,
+                new_unit_price=new_unit_price,
+                new_stock=new_stock,
             )
 
         if ext in {".xlsx", ".xlsm"}:
-            ...
+            if not HAS_OPENPYXL:
+                return (False, "No está instalado openpyxl. Instala con: pip install openpyxl")
             return _update_xlsx_row(
-                ...
+                p,
+                row_number=int(row_number),
+                code_col_index=int(code_col_index),
+                name_col_index=int(name_col_index),
+                category_col_index=int(category_col_index),
+                brand_col_index=int(brand_col_index),
+                unit_price_col_index=int(unit_price_col_index),
+                stock_col_index=int(stock_col_index),
+                sheet_name=sheet_name,
                 new_code=new_code,
                 new_name=new_name,
-                ...
+                new_category=new_category,
+                new_brand=new_brand,
+                new_unit_price=new_unit_price,
+                new_stock=new_stock,
             )
 
+        return (False, "Extensión no soportada (solo .csv, .xlsx, .xlsm).")
+
+    except PermissionError:
+        return (False, "Permiso denegado. ¿El archivo está abierto en Excel?")
+    except Exception as e:
+        return (False, str(e))
+
 def append_products_to_file(
     path: str,
     products_to_add: List[dict],
     code_col_index: int,
     name_col_index: int,
     sheet_name: str = None,
     has_headers: bool = True,
     header_row_number: int = 1,
 ):
     """
     Agrega nuevas filas al final del archivo (CSV/XLSX/XLSM) con Id y Nombre producto.
     products_to_add: lista de dicts: {"code": "...", "name": "..."}.
     Retorna (ok: bool, err: str, added_count: int)
     """
     try:
         p = Path(path)
         if not p.exists() or p.is_dir():
             return (False, "La ruta del archivo no existe o es una carpeta.", 0)
 
         ext = p.suffix.lower()
         if not products_to_add:
             return (True, "", 0)
 
         if header_row_number < 1:
             header_row_number = 1
